# ì„¸ìƒì˜ëª¨ë“ ê²ƒ-ëŒ“ê¸€ë‹¬ê¸°-ê²Œì‹œíŒ - ì •ë°€ ê¸°íšì„œ ë° êµ¬í˜„ ì§€ì‹œì„œ

> ì´ ë¬¸ì„œë¥¼ í´ë¡œë“œ ì½”ë“œì— ê·¸ëŒ€ë¡œ ì…ë ¥í•˜ë©´ ë™ì¼í•œ ê²Œì‹œíŒì´ ì¬í˜„ë©ë‹ˆë‹¤.
> ì¶”ê°€ ê¸°ëŠ¥ í™•ì¥ì´ ìš©ì´í•˜ë„ë¡ êµ¬ì¡°ë¥¼ ì„¤ê³„í•©ë‹ˆë‹¤.

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

- **í”„ë¡œì íŠ¸ëª…**: `bulletin-board`
- **ê²Œì‹œíŒ ì´ë¦„**: `ì„¸ìƒì˜ëª¨ë“ ê²ƒ-ëŒ“ê¸€ë‹¬ê¸°-ê²Œì‹œíŒ`
- **ì„¤ëª…**: íšŒì›ê°€ì…/ë¡œê·¸ì¸, ê²Œì‹œê¸€ CRUD, ë¬´í•œ ëŒ€ëŒ“ê¸€, ì¶”ì²œ/ë¹„ì¶”ì²œ, ê²€ìƒ‰/í˜ì´ì§€ë„¤ì´ì…˜, ë‹¤í¬ëª¨ë“œë¥¼ ê°–ì¶˜ í•œêµ­ì–´ ê²Œì‹œíŒ
- **ì–¸ì–´**: í•œêµ­ì–´ UI

---

## 2. ê¸°ìˆ  ìŠ¤íƒ (ì •í™•í•œ ë²„ì „)

| í•­ëª© | ê¸°ìˆ  | ë²„ì „ |
|------|------|------|
| í”„ë ˆì„ì›Œí¬ | Next.js (App Router) | 16.x |
| ì–¸ì–´ | TypeScript | 5.x |
| UI ë¼ì´ë¸ŒëŸ¬ë¦¬ | React | 19.x |
| CSS | Tailwind CSS v4 | 4.x |
| ORM | Prisma | 7.x |
| DB ì–´ëŒ‘í„° | @prisma/adapter-better-sqlite3 | 7.x |
| DB | SQLite (better-sqlite3) | ìµœì‹  |
| ì¸ì¦ | next-auth (v5 beta) | 5.0.0-beta.30 |
| ë¹„ë°€ë²ˆí˜¸ í•´ì‹± | bcryptjs | 3.x |

### 2-1. package.json dependencies

```json
{
  "dependencies": {
    "@prisma/adapter-better-sqlite3": "^7.4.0",
    "@prisma/client": "^7.4.0",
    "bcryptjs": "^3.0.3",
    "better-sqlite3": "^12.6.2",
    "next": "16.1.6",
    "next-auth": "^5.0.0-beta.30",
    "prisma": "^7.4.0",
    "react": "19.2.3",
    "react-dom": "19.2.3"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/bcryptjs": "^2.4.6",
    "@types/better-sqlite3": "^7.6.13",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "16.1.6",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}
```

---

## 3. í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì • ì§€ì‹œ

```bash
npx create-next-app@latest bulletin-board --typescript --tailwind --eslint --app --src-dir
cd bulletin-board
npm install @prisma/adapter-better-sqlite3 @prisma/client prisma better-sqlite3 bcryptjs next-auth@beta
npm install -D @types/bcryptjs @types/better-sqlite3
npx prisma init --datasource-provider sqlite --output ../src/generated/prisma
```

### 3-1. í™˜ê²½ë³€ìˆ˜ (.env)

```env
DATABASE_URL="file:./dev.db"
AUTH_SECRET="bulletin-board-secret-change-in-production"
```

### 3-2. Prisma ì„¤ì • (prisma.config.ts)

```typescript
import path from "node:path";
import type { PrismaConfig } from "prisma";

export default {
  earlyAccess: true,
  schema: path.join("prisma", "schema.prisma"),
} satisfies PrismaConfig;
```

### 3-3. PostCSS ì„¤ì • (postcss.config.mjs)

```javascript
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};
export default config;
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (prisma/schema.prisma)

```prisma
generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String
  password  String
  createdAt DateTime  @default(now())
  posts     Post[]
  comments  Comment[]
  likes     Like[]
  dislikes  Dislike[]
}

model Post {
  id        String    @id @default(cuid())
  title     String
  content   String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  authorId  String
  author    User      @relation(fields: [authorId], references: [id])
  comments  Comment[]
  likes     Like[]
  dislikes  Dislike[]
}

model Like {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  @@unique([postId, userId])
}

model Dislike {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  @@unique([postId, userId])
}

model Comment {
  id        String    @id @default(cuid())
  content   String
  createdAt DateTime  @default(now())
  postId    String
  post      Post      @relation(fields: [postId], references: [id], onDelete: Cascade)
  authorId  String
  author    User      @relation(fields: [authorId], references: [id])
  parentId  String?
  parent    Comment?  @relation("CommentReplies", fields: [parentId], references: [id], onDelete: Cascade)
  replies   Comment[] @relation("CommentReplies")
}
```

**í•µì‹¬ ì„¤ê³„:**
- Like/Dislike: `@@unique([postId, userId])` â†’ ìœ ì €ë‹¹ 1ê°œë§Œ ê°€ëŠ¥
- Comment: ìê¸°ì°¸ì¡° ê´€ê³„ (`CommentReplies`) â†’ ë¬´í•œ ëŒ€ëŒ“ê¸€
- Post ì‚­ì œ ì‹œ ëŒ“ê¸€/ì¢‹ì•„ìš”/ë¹„ì¶”ì²œ ëª¨ë‘ cascade ì‚­ì œ

---

## 5. íŒŒì¼ êµ¬ì¡° (ì „ì²´)

```
bulletin-board/
â”œâ”€â”€ .env
â”œâ”€â”€ prisma.config.ts
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ globals.css
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ (SessionProvider, ThemeProvider, Header)
â”‚   â”‚   â”œâ”€â”€ page.tsx                # / â†’ /posts ë¦¬ë‹¤ì´ë ‰íŠ¸
â”‚   â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”‚   â”œâ”€â”€ login/page.tsx      # ë¡œê·¸ì¸ í˜ì´ì§€
â”‚   â”‚   â”‚   â””â”€â”€ register/page.tsx   # íšŒì›ê°€ì… í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ posts/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx            # ê²Œì‹œê¸€ ëª©ë¡ (ì„œë²„ ì»´í¬ë„ŒíŠ¸, Prisma ì§ì ‘ í˜¸ì¶œ)
â”‚   â”‚   â”‚   â”œâ”€â”€ new/page.tsx        # ìƒˆ ê¸€ ì‘ì„±
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ page.tsx        # ê²Œì‹œê¸€ ìƒì„¸ (ì„œë²„ ì»´í¬ë„ŒíŠ¸, Prisma ì§ì ‘ í˜¸ì¶œ)
â”‚   â”‚   â”‚       â””â”€â”€ edit/page.tsx   # ê²Œì‹œê¸€ ìˆ˜ì •
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â”œâ”€â”€ auth/
â”‚   â”‚       â”‚   â”œâ”€â”€ [...nextauth]/route.ts  # NextAuth í•¸ë“¤ëŸ¬
â”‚   â”‚       â”‚   â””â”€â”€ register/route.ts       # íšŒì›ê°€ì… API
â”‚   â”‚       â””â”€â”€ posts/
â”‚   â”‚           â”œâ”€â”€ route.ts                # GET(ëª©ë¡), POST(ìƒì„±)
â”‚   â”‚           â””â”€â”€ [id]/
â”‚   â”‚               â”œâ”€â”€ route.ts            # GET/PUT/DELETE ê²Œì‹œê¸€
â”‚   â”‚               â”œâ”€â”€ comments/route.ts   # GET/POST/DELETE ëŒ“ê¸€
â”‚   â”‚               â”œâ”€â”€ like/route.ts       # GET/POST ì¶”ì²œ
â”‚   â”‚               â””â”€â”€ dislike/route.ts    # GET/POST ë¹„ì¶”ì²œ
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Header.tsx              # ìƒë‹¨ í—¤ë” (ë„¤ë¹„ê²Œì´ì…˜, ë‹¤í¬ëª¨ë“œ í† ê¸€, ë¡œê·¸ì¸ ìƒíƒœ)
â”‚   â”‚   â”œâ”€â”€ SessionProvider.tsx     # NextAuth ì„¸ì…˜ ë˜í¼
â”‚   â”‚   â”œâ”€â”€ ThemeProvider.tsx       # ë‹¤í¬ëª¨ë“œ í…Œë§ˆ ê´€ë¦¬ (localStorage)
â”‚   â”‚   â”œâ”€â”€ PostForm.tsx            # ê²Œì‹œê¸€ ì‘ì„±/ìˆ˜ì • í¼
â”‚   â”‚   â”œâ”€â”€ DeletePostButton.tsx    # ê²Œì‹œê¸€ ì‚­ì œ ë²„íŠ¼
â”‚   â”‚   â”œâ”€â”€ LikeButton.tsx          # ì¶”ì²œ/ë¹„ì¶”ì²œ ë²„íŠ¼ (ìƒí˜¸ë°°íƒ€ì )
â”‚   â”‚   â””â”€â”€ CommentSection.tsx      # ëŒ“ê¸€ ì„¹ì…˜ (ë¬´í•œ ëŒ€ëŒ“ê¸€, ì¬ê·€ ì»´í¬ë„ŒíŠ¸)
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ auth.ts                 # NextAuth v5 ì„¤ì •
â”‚   â”‚   â””â”€â”€ prisma.ts               # Prisma í´ë¼ì´ì–¸íŠ¸ ì‹±ê¸€í„´
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ next-auth.d.ts          # NextAuth íƒ€ì… í™•ì¥
```

---

## 6. í•µì‹¬ êµ¬í˜„ ì‚¬í•­ (ê¸°ëŠ¥ë³„ ìƒì„¸)

### 6-1. ì¸ì¦ ì‹œìŠ¤í…œ

#### Prisma í´ë¼ì´ì–¸íŠ¸ (src/lib/prisma.ts)
- `@prisma/adapter-better-sqlite3` ì‚¬ìš©í•˜ì—¬ SQLite ì—°ê²°
- ê¸€ë¡œë²Œ ì‹±ê¸€í„´ íŒ¨í„´ (ê°œë°œ í™˜ê²½ í•« ë¦¬ë¡œë“œ ëŒ€ì‘)

```typescript
import { PrismaClient } from "@/generated/prisma/client";
import { PrismaBetterSqlite3 } from "@prisma/adapter-better-sqlite3";

const globalForPrisma = globalThis as unknown as { prisma: PrismaClient | undefined };

function createPrismaClient() {
  const adapter = new PrismaBetterSqlite3({ url: process.env.DATABASE_URL! });
  return new PrismaClient({ adapter });
}

export const prisma = globalForPrisma.prisma ?? createPrismaClient();
if (process.env.NODE_ENV !== "production") globalForPrisma.prisma = prisma;
```

#### NextAuth ì„¤ì • (src/lib/auth.ts)
- Credentials í”„ë¡œë°”ì´ë” (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸)
- JWT ì„¸ì…˜ ì „ëµ
- ì½œë°±ì—ì„œ `token.id`ì— ìœ ì € ID ì €ì¥
- ë¡œê·¸ì¸ í˜ì´ì§€: `/login`

#### íšŒì›ê°€ì… API (POST /api/auth/register)
- ì´ë©”ì¼ ì¤‘ë³µ ê²€ì‚¬
- bcryptjsë¡œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹±
- ìœ ì € ìƒì„± í›„ ì„±ê³µ ì‘ë‹µ

#### íƒ€ì… í™•ì¥ (src/types/next-auth.d.ts)
- Session.userì— `id: string` ì¶”ê°€

#### ë¡œê·¸ì¸ í˜ì´ì§€ (src/app/(auth)/login/page.tsx)
- `"use client"` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
- `signIn("credentials", { email, password, redirect: false })` í˜¸ì¶œ
- ì„±ê³µ ì‹œ `/posts`ë¡œ ì´ë™
- ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- íšŒì›ê°€ì… í˜ì´ì§€ ë§í¬

#### íšŒì›ê°€ì… í˜ì´ì§€ (src/app/(auth)/register/page.tsx)
- `"use client"` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
- ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
- ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ/ìˆ¨ê¸°ê¸° í† ê¸€ ë²„íŠ¼
- `/api/auth/register`ë¡œ POST ìš”ì²­
- ì„±ê³µ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™

---

### 6-2. ê²Œì‹œê¸€ CRUD

#### ê²Œì‹œê¸€ ëª©ë¡ (src/app/posts/page.tsx) â€” ì„œë²„ ì»´í¬ë„ŒíŠ¸
**ë§¤ìš° ì¤‘ìš”: `fetch()`ê°€ ì•„ë‹Œ `prisma`ë¥¼ ì§ì ‘ í˜¸ì¶œí•´ì•¼ í•¨**

```typescript
// ì˜¬ë°”ë¥¸ ë°©ì‹ (Prisma ì§ì ‘ í˜¸ì¶œ)
const posts = await prisma.post.findMany({
  where: searchFilter,
  orderBy: { createdAt: "desc" },
  skip: (page - 1) * pageSize,
  take: pageSize,
  include: {
    author: { select: { name: true } },
    _count: { select: { comments: true, likes: true, dislikes: true } },
  },
});
```

**í‘œì‹œ ì •ë³´:**
- ë²ˆí˜¸ (ì—­ìˆœ: totalCount - index - skip)
- ì œëª©
- ì‘ì„±ì
- ì‘ì„±ì¼ (YYYY.MM.DD HH:mm í˜•ì‹, í•œêµ­ì–´)
- ì¶”ì²œìˆ˜, ë¹„ì¶”ì²œìˆ˜, ëŒ“ê¸€ìˆ˜
- ê²€ìƒ‰ (ì œëª©+ë‚´ìš© ë™ì‹œ ê²€ìƒ‰, OR ì¡°ê±´)
- í˜ì´ì§€ë„¤ì´ì…˜ (10ê°œì”©, ì´ì „/ë‹¤ìŒ ë²„íŠ¼)
- ë¡œê·¸ì¸ ì‹œì—ë§Œ "ìƒˆ ê¸€ ì‘ì„±" ë²„íŠ¼ í‘œì‹œ

#### ê²Œì‹œê¸€ ìƒì„¸ (src/app/posts/[id]/page.tsx) â€” ì„œë²„ ì»´í¬ë„ŒíŠ¸
**ë§¤ìš° ì¤‘ìš”: `fetch()`ê°€ ì•„ë‹Œ `prisma`ë¥¼ ì§ì ‘ í˜¸ì¶œí•´ì•¼ í•¨**

- Next.js 15+ ë¹„ë™ê¸° params: `params: Promise<{ id: string }>`
- ê²Œì‹œê¸€ ë‚´ìš©ì— URL ìë™ ë§í¬í™”:
```typescript
// URLì„ ê°ì§€í•˜ì—¬ í´ë¦­ ê°€ëŠ¥í•œ ë§í¬ë¡œ ë³€í™˜, ìƒˆ íƒ­ì—ì„œ ì—´ë¦¼
{post.content.split(/(https?:\/\/[^\s]+)/g).map((part, i) =>
  part.match(/^https?:\/\//) ? (
    <a key={i} href={part} target="_blank" rel="noopener noreferrer"
       className="text-blue-600 dark:text-blue-400 underline hover:text-blue-800">
      {part}
    </a>
  ) : (part)
)}
```
- ì‘ì„±ìë§Œ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
- LikeButton ì»´í¬ë„ŒíŠ¸ (ë¡œê·¸ì¸ ì—¬ë¶€ ì „ë‹¬)
- CommentSection ì»´í¬ë„ŒíŠ¸

#### ê²Œì‹œê¸€ ì‘ì„± (src/app/posts/new/page.tsx) â€” ì„œë²„ ì»´í¬ë„ŒíŠ¸
- ë¯¸ë¡œê·¸ì¸ ì‹œ `/login`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- PostForm ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©

#### ê²Œì‹œê¸€ ìˆ˜ì • (src/app/posts/[id]/edit/page.tsx) â€” ì„œë²„ ì»´í¬ë„ŒíŠ¸
- ë¯¸ë¡œê·¸ì¸ ì‹œ `/login`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ì‘ì„±ìê°€ ì•„ë‹Œ ê²½ìš° `/posts`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- PostForm ì»´í¬ë„ŒíŠ¸ì— ì´ˆê¸°ê°’ ì „ë‹¬ (`initialData`, `postId`)

#### PostForm ì»´í¬ë„ŒíŠ¸ (src/components/PostForm.tsx)
- `"use client"` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
- ìƒì„± ëª¨ë“œ: POST /api/posts
- ìˆ˜ì • ëª¨ë“œ: PUT /api/posts/[id]
- ì œì¶œ í›„ `router.refresh()` í˜¸ì¶œ í›„ `router.push()` (ìºì‹œ ê°±ì‹ )

#### DeletePostButton ì»´í¬ë„ŒíŠ¸ (src/components/DeletePostButton.tsx)
- `confirm()` í™•ì¸ ëŒ€í™”ìƒì
- DELETE /api/posts/[id] í˜¸ì¶œ
- ì‚­ì œ í›„ `/posts`ë¡œ ì´ë™

#### ê²Œì‹œê¸€ API

**POST /api/posts** (ìƒì„±)
- ì¸ì¦ í•„ìš”
- title, content ìœ íš¨ì„± ê²€ì‚¬
- authorId = session.user.id

**GET /api/posts** (ëª©ë¡)
- ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°: page, search
- ê²€ìƒ‰: title OR contentì—ì„œ contains ê²€ìƒ‰
- _count: comments, likes, dislikes í¬í•¨

**GET /api/posts/[id]** (ìƒì„¸)
- ëŒ“ê¸€ í¬í•¨ (ì¬ê·€ ì¤‘ì²©, ê¹Šì´ 10)

**PUT /api/posts/[id]** (ìˆ˜ì •)
- ì¸ì¦ + ì‘ì„±ì í™•ì¸
- title, content ì—…ë°ì´íŠ¸

**DELETE /api/posts/[id]** (ì‚­ì œ)
- ì¸ì¦ + ì‘ì„±ì í™•ì¸
- cascadeë¡œ ëŒ“ê¸€/ì¢‹ì•„ìš”/ë¹„ì¶”ì²œ ëª¨ë‘ ì‚­ì œ

---

### 6-3. ì¶”ì²œ/ë¹„ì¶”ì²œ ì‹œìŠ¤í…œ

#### LikeButton ì»´í¬ë„ŒíŠ¸ (src/components/LikeButton.tsx)
- `"use client"` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
- Props: `postId: string`, `isLoggedIn: boolean`
- useEffectì—ì„œ like/dislike ìƒíƒœë¥¼ ë³‘ë ¬ë¡œ fetch

**ì¶”ì²œ ë²„íŠ¼:**
- í•˜íŠ¸ ì•„ì´ì½˜ (â™¥)
- í™œì„±: ë¹¨ê°„ìƒ‰ ë°°ê²½ (`bg-red-100 text-red-600`)
- í´ë¦­ ì‹œ POST /api/posts/[id]/like

**ë¹„ì¶”ì²œ ë²„íŠ¼:**
- ì—„ì§€ ì•„ë˜ ì•„ì´ì½˜ (ğŸ‘)
- í™œì„±: íŒŒë€ìƒ‰ ë°°ê²½ (`bg-blue-100 text-blue-600`)
- í´ë¦­ ì‹œ POST /api/posts/[id]/dislike

**ìƒí˜¸ë°°íƒ€ ë¡œì§ (ë§¤ìš° ì¤‘ìš”):**
- ì¶”ì²œ í´ë¦­ â†’ ë¹„ì¶”ì²œì´ ìˆìœ¼ë©´ ìë™ í•´ì œ (ì„œë²„ì—ì„œ `prisma.dislike.deleteMany()`)
- ë¹„ì¶”ì²œ í´ë¦­ â†’ ì¶”ì²œì´ ìˆìœ¼ë©´ ìë™ í•´ì œ (ì„œë²„ì—ì„œ `prisma.like.deleteMany()`)
- í´ë¼ì´ì–¸íŠ¸: ë‚™ê´€ì  UI ì—…ë°ì´íŠ¸ í›„ ì„œë²„ ì‘ë‹µìœ¼ë¡œ ì¬ë™ê¸°í™”

#### Like API (POST /api/posts/[id]/like)
```
1. ì¸ì¦ í™•ì¸
2. ê¸°ì¡´ Like ì¡´ì¬ í™•ì¸
3. ì¡´ì¬í•˜ë©´ â†’ Like ì‚­ì œ (í† ê¸€ off)
4. ì—†ìœ¼ë©´ â†’ Dislike ì‚­ì œ + Like ìƒì„± (ìƒí˜¸ë°°íƒ€)
5. ìµœì¢… Like ê°œìˆ˜ ë°˜í™˜
```

#### Dislike API (POST /api/posts/[id]/dislike)
```
1. ì¸ì¦ í™•ì¸
2. ê¸°ì¡´ Dislike ì¡´ì¬ í™•ì¸
3. ì¡´ì¬í•˜ë©´ â†’ Dislike ì‚­ì œ (í† ê¸€ off)
4. ì—†ìœ¼ë©´ â†’ Like ì‚­ì œ + Dislike ìƒì„± (ìƒí˜¸ë°°íƒ€)
5. ìµœì¢… Dislike ê°œìˆ˜ ë°˜í™˜
```

---

### 6-4. ëŒ“ê¸€ ì‹œìŠ¤í…œ (ë¬´í•œ ëŒ€ëŒ“ê¸€)

#### CommentSection ì»´í¬ë„ŒíŠ¸ (src/components/CommentSection.tsx)
- `"use client"` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
- Props: `postId: string`

**ëŒ“ê¸€ íŠ¸ë¦¬ êµ¬ì¡°:**
- CommentItem (ì¬ê·€ ì»´í¬ë„ŒíŠ¸) â†’ ìì‹ repliesë¥¼ ë‹¤ì‹œ CommentItemìœ¼ë¡œ ë Œë”ë§
- ê¹Šì´ë³„ ìƒ‰ìƒ í‘œì‹œ (ì™¼ìª½ í…Œë‘ë¦¬):
  - ê¹Šì´ 0: blue
  - ê¹Šì´ 1: green
  - ê¹Šì´ 2: purple
  - ê¹Šì´ 3: orange
  - ê¹Šì´ 4+: gray
- ë“¤ì—¬ì“°ê¸°: `ml-3 pl-2 border-l-2`

**ëŒ“ê¸€ ë‚´ URL ìë™ ë§í¬í™”:**
```typescript
{comment.content.split(/(https?:\/\/[^\s]+)/g).map((part, i) =>
  part.match(/^https?:\/\//) ? (
    <a key={i} href={part} target="_blank" rel="noopener noreferrer"
       className="text-blue-600 dark:text-blue-400 underline">
      {part}
    </a>
  ) : (part)
)}
```

**ê¸°ëŠ¥:**
- ëŒ“ê¸€ ì‘ì„± (ë¡œê·¸ì¸ ì‹œ)
- ë‹µê¸€ ë‹¬ê¸° (ê° ëŒ“ê¸€ì— "ë‹µê¸€" ë²„íŠ¼ â†’ ì¸ë¼ì¸ ë‹µê¸€ í¼)
- ëŒ“ê¸€ ì‚­ì œ (ì‘ì„±ìë§Œ, confirm ëŒ€í™”ìƒì)
- ì‚­ì œ ì‹œ í•˜ìœ„ ë‹µê¸€ ëª¨ë‘ cascade ì‚­ì œ

#### Comments API

**GET /api/posts/[id]/comments**
- ìµœìƒìœ„ ëŒ“ê¸€ë§Œ ì¡°íšŒ (`parentId: null`)
- ì¬ê·€ì ìœ¼ë¡œ replies í¬í•¨ (ê¹Šì´ 10)
- ì¬ê·€ include ë¹Œë” í•¨ìˆ˜:

```typescript
function buildReplyInclude(depth: number): object {
  if (depth <= 0) {
    return { author: { select: { id: true, name: true, email: true } } };
  }
  return {
    author: { select: { id: true, name: true, email: true } },
    replies: {
      orderBy: { createdAt: "asc" as const },
      include: buildReplyInclude(depth - 1),
    },
  };
}
```

**POST /api/posts/[id]/comments**
- ì¸ì¦ í•„ìš”
- `content`: ëŒ“ê¸€ ë‚´ìš©
- `parentId`: (ì„ íƒ) ë¶€ëª¨ ëŒ“ê¸€ ID â†’ ëŒ€ëŒ“ê¸€

**DELETE /api/posts/[id]/comments** (body: `{ commentId }`)
- ì¸ì¦ + ì‘ì„±ì í™•ì¸
- cascadeë¡œ í•˜ìœ„ ë‹µê¸€ ëª¨ë‘ ì‚­ì œ

---

### 6-5. ë‹¤í¬ëª¨ë“œ

#### globals.css
```css
@import "tailwindcss";
@custom-variant dark (&:where(.dark *));

:root {
  --background: #ffffff;
  --foreground: #171717;
}

.dark {
  --background: #0a0a0a;
  --foreground: #ededed;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}
```

#### ThemeProvider ì»´í¬ë„ŒíŠ¸
- `"use client"` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
- `createContext`ë¡œ í…Œë§ˆ ìƒíƒœ ê³µìœ 
- `localStorage`ì— í…Œë§ˆ ì €ì¥ (`theme` í‚¤)
- ì´ˆê¸°ê°’: localStorage â†’ ì‹œìŠ¤í…œ ì„¤ì • (`prefers-color-scheme`) â†’ `light`
- `document.documentElement.classList`ì— `dark` í´ë˜ìŠ¤ í† ê¸€
- `useTheme()` í›… ì œê³µ

#### Header ì»´í¬ë„ŒíŠ¸
- ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ (â˜€ï¸ / ğŸŒ™ ì•„ì´ì½˜)
- ê²Œì‹œíŒ ì´ë¦„: "ì„¸ìƒì˜ëª¨ë“ ê²ƒ-ëŒ“ê¸€ë‹¬ê¸°-ê²Œì‹œíŒ"
- ì„¸ì…˜ ìƒíƒœì— ë”°ë¥¸ ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
- ì‚¬ìš©ì ì´ë¦„ í‘œì‹œ

---

### 6-6. UI ë””ìì¸ ì›ì¹™

#### ìš¸íŠ¸ë¼ ì»´íŒ©íŠ¸ ë””ìì¸
- ìµœëŒ€í•œì˜ ì •ë³´ ë°€ë„
- ì—¬ë°± ìµœì†Œí™”: `p-1`, `px-2`, `py-0.5`, `space-y-0`
- í—¤ë” ë†’ì´: `h-10`
- ì‘ì€ í°íŠ¸: `text-xs`, `text-sm`
- ì»´íŒ©íŠ¸í•œ ë²„íŠ¼: `px-2 py-0.5 text-xs`
- ëŒ“ê¸€ ë“¤ì—¬ì“°ê¸°: `ml-3 pl-2` (ê³¼ë„í•˜ì§€ ì•Šê²Œ)

#### ë‹¤í¬ëª¨ë“œ ìƒ‰ìƒ ì²´ê³„
- ë°°ê²½: `bg-white` / `dark:bg-gray-900`
- ì¹´ë“œ: `bg-gray-50` / `dark:bg-gray-800`
- í…ìŠ¤íŠ¸: `text-gray-900` / `dark:text-gray-100`
- ë³´ì¡° í…ìŠ¤íŠ¸: `text-gray-500` / `dark:text-gray-400`
- í…Œë‘ë¦¬: `border-gray-200` / `dark:border-gray-700`
- ì…ë ¥í•„ë“œ: `bg-white` / `dark:bg-gray-700`
- ë§í¬: `text-blue-600` / `dark:text-blue-400`

#### ë°˜ì‘í˜•
- Tailwind CSSë¡œ ë°˜ì‘í˜• ì²˜ë¦¬
- ìµœëŒ€ ë„ˆë¹„: `max-w-4xl mx-auto` (ê²Œì‹œê¸€ ëª©ë¡/ìƒì„¸)

---

## 7. ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ êµ¬ì¡°

```
<html lang="ko" suppressHydrationWarning>
  <body>
    <SessionProvider>       â† NextAuth ì„¸ì…˜ ê³µìœ 
      <ThemeProvider>       â† ë‹¤í¬ëª¨ë“œ í…Œë§ˆ ê´€ë¦¬
        <Header />          â† ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜
        <main>{children}</main>
      </ThemeProvider>
    </SessionProvider>
  </body>
</html>
```

- í°íŠ¸: Geist Sans + Geist Mono (Google Fonts)
- metadata: title = "ì„¸ìƒì˜ëª¨ë“ ê²ƒ-ëŒ“ê¸€ë‹¬ê¸°-ê²Œì‹œíŒ"
- `suppressHydrationWarning` í•„ìˆ˜ (ë‹¤í¬ëª¨ë“œ ì´ˆê¸°í™” ì‹œ hydration ë¶ˆì¼ì¹˜ ë°©ì§€)

---

## 8. ì£¼ìš” ì£¼ì˜ì‚¬í•­ (ë°˜ë“œì‹œ ì§€í‚¬ ê²ƒ)

### 8-1. ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ Prisma ì§ì ‘ í˜¸ì¶œ
**ì ˆëŒ€ë¡œ ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì²´ APIë¥¼ fetch()ë¡œ í˜¸ì¶œí•˜ì§€ ë§ˆì„¸ìš”.**
Next.js App Routerì—ì„œëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ê°€ ìì‹ ì˜ API routeë¥¼ í˜¸ì¶œí•˜ë©´ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤.
ì„œë²„ ì»´í¬ë„ŒíŠ¸ (posts/page.tsx, posts/[id]/page.tsx, posts/[id]/edit/page.tsx)ì—ì„œëŠ”
ë°˜ë“œì‹œ `prisma`ë¥¼ ì§ì ‘ importí•˜ì—¬ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.

```typescript
// âŒ ì˜ëª»ëœ ë°©ì‹
const res = await fetch(`${process.env.NEXTAUTH_URL}/api/posts`);

// âœ… ì˜¬ë°”ë¥¸ ë°©ì‹
import { prisma } from "@/lib/prisma";
const posts = await prisma.post.findMany({ ... });
```

### 8-2. Next.js 15+ ë¹„ë™ê¸° params
```typescript
// âœ… ì˜¬ë°”ë¥¸ ë°©ì‹
export default async function Page({ params }: { params: Promise<{ id: string }> }) {
  const { id } = await params;
}
```

### 8-3. Tailwind CSS v4 ë‹¤í¬ëª¨ë“œ
```css
/* globals.cssì— ë°˜ë“œì‹œ í¬í•¨ */
@custom-variant dark (&:where(.dark *));
```
ì´ê²ƒì´ ì—†ìœ¼ë©´ `dark:` ì ‘ë‘ì‚¬ê°€ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 8-4. Prisma 7 + SQLite ì–´ëŒ‘í„°
Prisma 7ì—ì„œëŠ” ë°˜ë“œì‹œ `@prisma/adapter-better-sqlite3`ë¥¼ ì‚¬ìš©í•˜ê³ ,
PrismaClient ìƒì„± ì‹œ ì–´ëŒ‘í„°ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.

### 8-5. .gitignoreì— í¬í•¨í•  í•­ëª©
```gitignore
*.db
*.db-journal
/src/generated/prisma
```

---

## 9. ì‹¤í–‰ ë°©ë²•

```bash
# 1. ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# 2. Prisma í´ë¼ì´ì–¸íŠ¸ ìƒì„±
npx prisma generate

# 3. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
npx prisma migrate dev

# 4. ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev
```

ì ‘ì†: http://localhost:3000

---

## 10. ê¸°ëŠ¥ í™•ì¥ ê°€ì´ë“œ (ì¶”ê°€ ê¸°ëŠ¥ ì œì•ˆ)

ì´ í”„ë¡œì íŠ¸ì— ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ë“¤:

### 10-1. ì¦‰ì‹œ ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥
| ê¸°ëŠ¥ | ì„¤ëª… | ë‚œì´ë„ |
|------|------|--------|
| ì¡°íšŒìˆ˜ | Post ëª¨ë¸ì— `viewCount Int @default(0)` ì¶”ê°€ | ì‰¬ì›€ |
| í”„ë¡œí•„ í˜ì´ì§€ | ì‚¬ìš©ì ì‘ì„± ê¸€/ëŒ“ê¸€ ëª¨ì•„ë³´ê¸° | ì‰¬ì›€ |
| ê²Œì‹œê¸€ ì¹´í…Œê³ ë¦¬ | Category ëª¨ë¸ ì¶”ê°€, ê²Œì‹œê¸€ ë¶„ë¥˜ | ë³´í†µ |
| ì´ë¯¸ì§€ ì—…ë¡œë“œ | ê²Œì‹œê¸€ì— ì´ë¯¸ì§€ ì²¨ë¶€ | ë³´í†µ |
| ë§ˆí¬ë‹¤ìš´ ì§€ì› | ê²Œì‹œê¸€/ëŒ“ê¸€ì— ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ | ë³´í†µ |
| ì•Œë¦¼ ì‹œìŠ¤í…œ | ë‚´ ê¸€ì— ëŒ“ê¸€/ì¶”ì²œ ì•Œë¦¼ | ë³´í†µ |
| ì¸ê¸°ê¸€ ì •ë ¬ | ì¶”ì²œìˆ˜/ëŒ“ê¸€ìˆ˜ ê¸°ì¤€ ì •ë ¬ | ì‰¬ì›€ |
| ë¶ë§ˆí¬ | ê²Œì‹œê¸€ ì¦ê²¨ì°¾ê¸° | ì‰¬ì›€ |

### 10-2. ê³ ê¸‰ í™•ì¥
| ê¸°ëŠ¥ | ì„¤ëª… | ë‚œì´ë„ |
|------|------|--------|
| ì†Œì…œ ë¡œê·¸ì¸ | Google, GitHub OAuth ì¶”ê°€ | ë³´í†µ |
| ê´€ë¦¬ì í˜ì´ì§€ | ìœ ì €/ê²Œì‹œê¸€ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ | ì–´ë ¤ì›€ |
| ì‹¤ì‹œê°„ ì•Œë¦¼ | WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ ì•Œë¦¼ | ì–´ë ¤ì›€ |
| ì´ë©”ì¼ ì¸ì¦ | íšŒì›ê°€ì… ì‹œ ì´ë©”ì¼ í™•ì¸ | ë³´í†µ |
| ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • | ì´ë©”ì¼ ê¸°ë°˜ ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” | ë³´í†µ |
| ê²Œì‹œê¸€ ì‹ ê³  | ë¶€ì ì ˆí•œ ì½˜í…ì¸  ì‹ ê³  ê¸°ëŠ¥ | ë³´í†µ |
| ëŒ“ê¸€ ì¶”ì²œ | ëŒ“ê¸€ì—ë„ ì¶”ì²œ/ë¹„ì¶”ì²œ ì‹œìŠ¤í…œ | ë³´í†µ |
| ê²€ìƒ‰ ê³ ë„í™” | ì‘ì„±ì ê²€ìƒ‰, ë‚ ì§œ í•„í„° ë“± | ë³´í†µ |
| PostgreSQL ì „í™˜ | í”„ë¡œë•ì…˜ ë°°í¬ ì‹œ DB ì „í™˜ | ë³´í†µ |

---

## 11. í´ë¡œë“œ ì½”ë“œì— ì£¼ëŠ” ìµœì¢… ì§€ì‹œ (ë³µì‚¬í•˜ì—¬ ì‚¬ìš©)

ì•„ë˜ ë‚´ìš©ì„ í´ë¡œë“œ ì½”ë“œì— ì…ë ¥í•˜ë©´ ì´ í”„ë¡œì íŠ¸ë¥¼ ì²˜ìŒë¶€í„° êµ¬í˜„í•©ë‹ˆë‹¤:

---

```
ë‹¤ìŒ ì‚¬ì–‘ìœ¼ë¡œ ê²Œì‹œíŒ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì²˜ìŒë¶€í„° ë§Œë“¤ì–´ì¤˜:

â–  í”„ë¡œì íŠ¸ëª…: bulletin-board
â–  ê²Œì‹œíŒ ì´ë¦„: ì„¸ìƒì˜ëª¨ë“ ê²ƒ-ëŒ“ê¸€ë‹¬ê¸°-ê²Œì‹œíŒ
â–  UI ì–¸ì–´: í•œêµ­ì–´

â–  ê¸°ìˆ  ìŠ¤íƒ:
- Next.js (ìµœì‹ , App Router, TypeScript)
- Tailwind CSS v4
- Prisma 7 + SQLite (better-sqlite3 ì–´ëŒ‘í„°)
- NextAuth v5 beta (Credentials í”„ë¡œë°”ì´ë”, JWT ì„¸ì…˜)
- bcryptjs (ë¹„ë°€ë²ˆí˜¸ í•´ì‹±)

â–  ë°ì´í„° ëª¨ë¸:
- User (id, email, name, password, createdAt)
- Post (id, title, content, createdAt, updatedAt, authorId)
- Like (id, createdAt, postId, userId) â€” @@unique([postId, userId])
- Dislike (id, createdAt, postId, userId) â€” @@unique([postId, userId])
- Comment (id, content, createdAt, postId, authorId, parentId?) â€” ìê¸°ì°¸ì¡° ê´€ê³„ë¡œ ë¬´í•œ ëŒ€ëŒ“ê¸€

â–  ì¸ì¦ ê¸°ëŠ¥:
- íšŒì›ê°€ì… (ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸ â€” ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ/ìˆ¨ê¸°ê¸° í† ê¸€)
- ë¡œê·¸ì¸ (ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸)
- ì„¸ì…˜ ê¸°ë°˜ ë³´í˜¸ (ê¸€ ì‘ì„±/ìˆ˜ì •/ì‚­ì œ/ëŒ“ê¸€/ì¶”ì²œì€ ë¡œê·¸ì¸ í•„ìš”)

â–  ê²Œì‹œê¸€ ê¸°ëŠ¥:
- CRUD (ìƒì„±, ëª©ë¡ì¡°íšŒ, ìƒì„¸ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ)
- ëª©ë¡: 10ê°œì”© í˜ì´ì§€ë„¤ì´ì…˜, ì œëª©+ë‚´ìš© ê²€ìƒ‰
- ëª©ë¡ì— ë²ˆí˜¸/ì œëª©/ì‘ì„±ì/ë‚ ì§œ/ì¶”ì²œìˆ˜/ë¹„ì¶”ì²œìˆ˜/ëŒ“ê¸€ìˆ˜ í‘œì‹œ
- ê²Œì‹œê¸€ ë‚´ìš©ì—ì„œ URL ìë™ ê°ì§€í•˜ì—¬ í´ë¦­ ê°€ëŠ¥í•œ ë§í¬ë¡œ ë³€í™˜ (ìƒˆ íƒ­ ì—´ê¸°)
- ìˆ˜ì •/ì‚­ì œëŠ” ì‘ì„±ìë§Œ ê°€ëŠ¥

â–  ì¶”ì²œ/ë¹„ì¶”ì²œ:
- ì¶”ì²œ(â™¥)ê³¼ ë¹„ì¶”ì²œ(ğŸ‘) ë²„íŠ¼
- ìƒí˜¸ë°°íƒ€ì : ì¶”ì²œ ëˆ„ë¥´ë©´ ë¹„ì¶”ì²œ ìë™ í•´ì œ, ë¹„ì¶”ì²œ ëˆ„ë¥´ë©´ ì¶”ì²œ ìë™ í•´ì œ
- ë‚™ê´€ì  UI ì—…ë°ì´íŠ¸
- ìœ ì €ë‹¹ ê²Œì‹œê¸€ë‹¹ í•˜ë‚˜ë§Œ ê°€ëŠ¥

â–  ëŒ“ê¸€ ê¸°ëŠ¥:
- ë¬´í•œ ê¹Šì´ ëŒ€ëŒ“ê¸€ (ì¬ê·€ ì»´í¬ë„ŒíŠ¸)
- ê¹Šì´ë³„ ìƒ‰ìƒ ë‹¤ë¥¸ ì™¼ìª½ í…Œë‘ë¦¬ (blueâ†’greenâ†’purpleâ†’orangeâ†’gray)
- ëŒ“ê¸€ ë‚´ URL ìë™ ë§í¬í™” (ìƒˆ íƒ­ ì—´ê¸°)
- ë‹µê¸€ ë‹¬ê¸° ê¸°ëŠ¥ (ì¸ë¼ì¸ í¼)
- ì‚­ì œ ì‹œ í•˜ìœ„ ë‹µê¸€ cascade ì‚­ì œ
- ì‚­ì œëŠ” ì‘ì„±ìë§Œ ê°€ëŠ¥

â–  ë‹¤í¬ëª¨ë“œ:
- ThemeProvider (localStorage ì €ì¥, ì‹œìŠ¤í…œ ì„¤ì • ê°ì§€)
- í—¤ë”ì— â˜€ï¸/ğŸŒ™ í† ê¸€ ë²„íŠ¼
- Tailwind CSS v4: @custom-variant dark (&:where(.dark *))

â–  UI ë””ìì¸:
- ìš¸íŠ¸ë¼ ì»´íŒ©íŠ¸ (ìµœëŒ€ ì •ë³´ ë°€ë„, ìµœì†Œ ì—¬ë°±)
- ë‹¤í¬ëª¨ë“œ ì™„ì „ ì§€ì› (ëª¨ë“  ì»´í¬ë„ŒíŠ¸)
- ë°˜ì‘í˜• ë””ìì¸

â–  ì¤‘ìš” ê¸°ìˆ  ê·œì¹™:
1. ì„œë²„ ì»´í¬ë„ŒíŠ¸(posts/page.tsx, posts/[id]/page.tsx, posts/[id]/edit/page.tsx)ì—ì„œëŠ” ë°˜ë“œì‹œ prismaë¥¼ ì§ì ‘ í˜¸ì¶œ. ì ˆëŒ€ ìì²´ APIë¥¼ fetchí•˜ì§€ ë§ ê²ƒ
2. Next.js 15+ ë¹„ë™ê¸° params íŒ¨í„´ ì‚¬ìš©: params: Promise<{ id: string }>
3. Tailwind CSS v4ì—ì„œ globals.cssì— @custom-variant dark (&:where(.dark *)) í•„ìˆ˜
4. Prisma 7ì€ @prisma/adapter-better-sqlite3 ì–´ëŒ‘í„° í•„ìˆ˜
5. PostFormì—ì„œ ì œì¶œ í›„ router.refresh() â†’ router.push() ìˆœì„œë¡œ í˜¸ì¶œ

ëª¨ë“  ê¸°ëŠ¥ì„ ì™„ì „íˆ êµ¬í˜„í•˜ê³ , npm run devë¡œ ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ ìƒíƒœë¡œ ë§Œë“¤ì–´ì¤˜.
```
